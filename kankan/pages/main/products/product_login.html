<!DOCTYPE html>
<html>

	<head>
		<meta charset="utf-8">
		<title>product_login</title>
		<meta name="viewport" content="width=device-width, initial-scale=1,maximum-scale=1,user-scalable=no">
		<meta name="apple-mobile-web-app-capable" content="yes">
		<meta name="apple-mobile-web-app-status-bar-style" content="black">
		<link rel="stylesheet" href="../../../css/mui.min.css">
		<link rel="stylesheet" href="../../../css/kankan_home.css">
		<link href="../../../css/mui.picker.css" rel="stylesheet" />
		<link href="../../../css/mui.poppicker.css" rel="stylesheet" />
	</head>
	<body class="mui-fullscreen">
		<!--page main-->
		<div id="app" class="mui-views">
			<div class="mui-view">
				<div class="mui-navbar">
				</div>
				<div class="mui-pages">
				</div>
			</div>
		</div>
		<!--page main end-->
	<div id="productlogin" class="mui-page">
		<!--page title begin-->
			<div class="mui-navbar-inner mui-bar mui-bar-nav">
				<button type="button" class="mui-left mui-action-back mui-btn  mui-btn-link mui-btn-nav mui-pull-left">
					<span class="mui-icon mui-icon-left-nav"></span>
				</button>
				<h1 class="mui-center mui-title lang" data-locale="commodity_login"></h1>
			</div>
			<!--page title end-->
			<!--page main start-->
			<div class="mui-page-content">
				<div class="mui-scroll-wrapper">
					<div class="mui-scroll">
						<div class="mui-content kankan_jyimgbox">
							 <h5 class="ka_proloh5 ka_propicfonts lang" data-locale="commodity_photos"></h5>
							<div class="ka_prologbox0 z_photo">
								<div class="z_file" style="background-image: url(../../../images/iconfont-tianjia.png);" id="gallery">
									<!--<input type="file" name="file" id="file" value=""  class="takepic" accept="image/*" multiple onchange="imgChange('z_photo','z_file');" />-->
								</div>
								<div class="mui-pull-right mui-icon mui-icon-camera takepic" id="takepic"></div>
				            	 
							</div>
							<!--mask-->
					        <div class="z_mask">
					            <!--alert box-->
					            <div class="z_alert">
					                 <p class="lang" data-locale="commodity_photodet"></p>
					                <p>
					                    <span class="z_cancel lang" data-locale="det_goodconcel"></span>
					                    <span class="z_sure lang" data-locale="register"></span>
					                </p>
					            </div>
					        </div>
							     <br />
							     <div class="ka_prologbox">
								     <h5 class="ka_proloh5 lang" data-locale="commodity_name"></h5>
								    <ul class="mui-table-view">
							            <li class="mui-table-view-cell">
						                   <input type="text" class="lang" data-locale="commodity_namelength" id="productname" maxlength="40">
							            </li>
							            <li class="mui-table-view-cell">
							                 <textarea  class="ka_noborder" maxlength="1000"></textarea>
							            </li>
							        </ul>
							     </div>
							     <br />
							     <div class="ka_prologbox">
								     <h5 class="ka_proloh5 lang" data-locale="commodity_detail"></h5>
								    <ul class="mui-table-view">
							            <li class="mui-table-view-cell" >
							                <div class="mui-navigate-right"   id="showCityPicker">
							                    	<span class="ka_proinfo lang" data-locale="commodity_sorts" ></span>
							                    	<div class="mui-pull-right ka_bitian lang" data-locale="commodity_must" id="bitian1"></div>
							                    	<div id='sortResult' class="ui-alert mui-pull-right ka_sortname"></div>
							                </div>
							                
							            </li>
							            <li class="mui-table-view-cell">
							                <a class="mui-navigate-right" href="#productstaute" id="prostuat">
							                     	<span class="ka_proinfo lang" data-locale="commodity_stuates"></span>
							                     	<div class="mui-pull-right ka_bitian lang" data-locale="commodity_must"></div>
							                </a>
							            </li>
							            <li class="mui-table-view-cell">
					                     	<span class="ka_proinfo lang" data-locale="commodity_price"></span>
					                     	<div class="mui-pull-right">
					                     		<input type="text" name="price" id="price" value="" placeholder="0" cla="ka_comdprice" maxlength="10" />
					                     		<span class="comd_login_unit">P</span>
					                     	</div>
					                     	
							            </li>
							        </ul>
							    </div><br />
							    <div class="ka_prologbox">
							    	 <h5 class="ka_proloh5 lang" data-locale="commodity_buyway"></h5>
							    	 <ul class="mui-table-view">
							    	         <li class="mui-table-view-cell">
							    	             <div class="ka_userbox">
								    	            <div class="mui-pull-left ka_exchangered lang" data-locale="commodity_switch"></div>
								    	            <div class="mui-pull-left ka_exchangegrey lang" data-locale="commodity_free"></div>
								    	            <div class="mui-pull-left ka_exchangegrey lang" data-locale="commodity_pointbuy"></div>
							    	            </div>
							    	         </li>
							    	     </ul>
							    </div>
						</div><br/>
						<div class="ka_description lang" data-locale="commodity_forbidentext">
						</div>
						<div class="ka_userbox">
							<button type="button" class="mui-btn mui-btn-red ka_prologsure lang"  data-locale="commodity_buttonsure" onclick="return publish()"></button>
						</div>
						<br/>
						<div class="showimg">
				        </div>
				        
				    </div>    
				</div>
			</div>
    </div>
	 <!--productsataute page-->
	 	<div id="productstaute" class="mui-page">
			<div class="mui-navbar-inner mui-bar mui-bar-nav">
				<button type="button" class="mui-left mui-action-back mui-btn  mui-btn-link mui-btn-nav mui-pull-left">
					<span class="mui-icon mui-icon-left-nav"></span>
				</button>
				<h1 class="mui-center mui-title lang" data-locale="commodity_stuates"></h1>
			</div>
			<div class="mui-page-content">
				<div class="mui-scroll-wrapper">
					<div class="mui-scroll">
						<ul class="mui-table-view">
					        <li class="mui-table-view-cell">
					            <a class="mui-navigate-right" onclick="foundstuat(this)">
					              	<span class="ka_sortfont" >全新</span>
					            </a>
					        </li>
					        <li class="mui-table-view-cell">
					            <a class="mui-navigate-right" onclick="foundstuat(this)">
					            	   <span class="ka_sortfont">用了一年</span>
					            </a>
					        </li>
					        <li class="mui-table-view-cell">
					            <a class="mui-navigate-right" onclick="foundstuat(this)">
					             	  <span class="ka_sortfont">用了三年</span>
					            </a>
					        </li>
					    </ul>
					</div>
				</div>
			</div>
		</div>
	</body>
	<script src="../../../js/mui.min.js"></script>
	<script src="../../../js/mui.view.js "></script>
	<script src='../../../js/feedback.js'></script>
	<script src="../../../js/mui.picker.js"></script>
	<script src="../../../js/mui.poppicker.js"></script>
	<script src="../../../js/pro_loginsort.js" type="text/javascript" charset="utf-8"></script>
	<script src="../../../js/jquery-3.2.0.min.js"></script>
	<script src="../../../js/language.js"></script>
	<script src="../../../js/sha256.js"></script>
	<script src="../../../js/common.js"></script>
	<script src="../../../js/compress.js"></script>
	<script>
		$(function(){
			$(".ka_noborder").attr("placeholder",TextMessage.commodity_descriptionlength);
		});
		//sort 
		(function($, doc) {
				$.init();
				$.ready(function() {
					var cityPicker = new $.PopPicker({
						layer: 2
					});
					cityPicker.setData(cityData);
					var showCityPickerButton = doc.getElementById('showCityPicker');
					var cityResult = doc.getElementById('sortResult');
					showCityPickerButton.addEventListener('tap', function(event) {
						cityPicker.show(function(items) {
							cityResult.innerText =items[0].text + " " + items[1].text;
							//return  false Can prevent the selection box off
							//return false;
						});
						document.getElementById("bitian1").style.display="none";
					}, false);
					//-----------------------------------------	
				});
			})(mui, document);
		var viewApi = mui('#app').view({
			defaultPage: '#productlogin'
		});
		mui('.mui-scroll-wrapper').scroll();
		var view = viewApi.view;
		(function($) {
			//view back and webviewback
			var oldBack = $.back;
			$.back = function() {
				if (viewApi.canBack()) { 
					//view back
					viewApi.back();
				} else { 
					//webview back
					oldBack();
				}
			};
			view.addEventListener('pageBeforeShow', function(e) {
				//				console.log(e.detail.page.id + ' beforeShow');
			});
			view.addEventListener('pageShow', function(e) {
				//				console.log(e.detail.page.id + ' show');
			});
			view.addEventListener('pageBeforeBack', function(e) {
				//				console.log(e.detail.page.id + ' beforeBack');
			});
			view.addEventListener('pageBack', function(e) {
				//				console.log(e.detail.page.id + ' back');
			});
		})(mui);
		function publish(){
			return confirm(TextMessage.publishsure)
		}
		//stuat value
		function foundstuat(e){
			var stuat=$(e).children("span").html();
			$("#prostuat div").html(stuat);
			$("#prostuat div").removeClass("ka_bitian");
			$("#prostuat div").addClass("ka_sortname");
			$("#productstaute .ka_gaoliang").each(function(){
				$(this).removeClass("ka_gaoliang");
				$(this).addClass("ka_sortfont");
			});
			$(e).children("span").removeClass("ka_sortfont");
			$(e).children("span").addClass("ka_gaoliang");
			
		}
		///////////////take picture/////////////////
		function imglength(){
			var imglength=$(".z_addImg").length;
			    if(imglength>3){
			    	$(".z_file").hide();
			    	$("#takepic").hide();
			    }
		}
	     //px Convert to rem
        (function(doc, win) {
            var docEl = doc.documentElement,
                resizeEvt = 'orientationchange' in window ? 'orientationchange' : 'resize',
                recalc = function() {
                    var clientWidth = docEl.clientWidth;
                    if (!clientWidth) return;
                    if (clientWidth >= 640) {
                        docEl.style.fontSize = '100px';
                    } else {
                        docEl.style.fontSize = 100 * (clientWidth / 640) + 'px';
                    }
                };

            if (!doc.addEventListener) return;
            win.addEventListener(resizeEvt, recalc, false);
            doc.addEventListener('DOMContentLoaded', recalc, false);
        })(document, window);

        function imgRemove() {
            var imgList = document.getElementsByClassName("z_addImg");
            var mask = document.getElementsByClassName("z_mask")[0];
            var cancel = document.getElementsByClassName("z_cancel")[0];
            var sure = document.getElementsByClassName("z_sure")[0];
            for (var j = 0; j < imgList.length; j++) {
                imgList[j].index = j;
                imgList[j].onclick = function() {
                    var t = this;
                    mask.style.display = "block";
                    cancel.onclick = function() {
                        mask.style.display = "none";
                    };
                    sure.onclick = function() {
                        mask.style.display = "none";
                        t.style.display = "none";
                        var picdisp=$(".z_file").css("display");
                        if(picdisp=="none"){
                        	$(".z_file").show();
                        }
                        var takpic=$("#takepic").css("display");
                        if(takpic=="none"){
                        	$("#takepic").show();
                        }
                    };

                } 
            };
             
        };
        //take picture
        mui(".ka_prologbox0").on("tap", "#takepic",function(e) {
				if(mui.os.plus){
					var a = [{
						title: TextMessage.tackpicture
					}];
					plus.nativeUI.actionSheet({
						title: TextMessage.comdity_takepic,
						cancel: TextMessage.cancel,
						buttons: a
					}, function(b) {
						switch (b.index) {
							case 0:
								break;
							case 1:
								getImage();
								break;
							default:
								break
						}
					})	
				}
				
			});
			//gallery
			mui(".ka_prologbox0").on("tap", "#gallery",function(e) {
				if(mui.os.plus){
					var a = [{
						title: TextMessage.gallerychoose
					}];
					plus.nativeUI.actionSheet({
						title: TextMessage.chooseimage,
						cancel: TextMessage.cancel,
						buttons: a
					}, function(b) {
						switch (b.index) {
							case 0:
								break;
							case 1:
								galleryImg();
								break;
							default:
								break
						}
					})	
				}
				
			});
			//compressImage
			function compressImg(path){
				console.log(path);
				plus.zip.compressImage({
						src:path,
						dst:"_doc/123.jpg",
						quality:20,
						overwrite:true,
						format:"jpg"	
					},
					function(event) {
						alert("Compress success!");
						var target = event.target; // 压缩转换后的图片url路径，以"file://"开头
						var size = event.size; // 压缩转换后图片的大小，单位为字节（Byte）
						var width = event.width; // 压缩转换后图片的实际宽度，单位为px
						var height = event.height; // 压缩转换后图片的实际高度，单位为px
						alert(size);
					},function(error) {
						alert("Compress error!"+error.message);
				});
			}
			function getImage() {
				var c = plus.camera.getCamera();
				c.captureImage(function(e) {
					plus.io.resolveLocalFileSystemURL(e, function(entry) {
						//var s = entry.toLocalURL() + "?version=" + new Date().getTime();
						var localurl = entry.toLocalURL();
						console.log(localurl);
						var img = document.createElement("img");
		                img.setAttribute("src",localurl);
		                var imgAdd = document.createElement("div");
		                imgAdd.setAttribute("class", "z_addImg");
		                imgAdd.appendChild(img);
		                $(".z_photo").append(imgAdd);
		                 imglength();
		                 imgRemove();
		                 compressImg(localurl);
					}, function(e) {
						console.log("Read the picture file error：" + e.message);
					});
				}, function(s) {
					console.log("error" + s);
				}, {
					filename: "_doc/camera/"
				})
			}
			function galleryImg() {
			plus.gallery.pick(function(a) {
				plus.io.resolveLocalFileSystemURL(a, function(entry) {
					var localURL2 = entry.toLocalURL();
					console.log(localURL2);
					var img = document.createElement("img");
	                img.setAttribute("src",localURL2);
	                var imgAdd = document.createElement("div");
	                imgAdd.setAttribute("class", "z_addImg");
	                imgAdd.appendChild(img);
	                $(".z_photo").append(imgAdd);
	                 imglength();
	                 imgRemove();
	                 compressImg(localURL2);
						
				}, function(e) {
					console.log("Read photo file error：" + e.message);
				});
			}, function(a) {}, {
				filter: "image"
			})
		};
	</script>

</html>